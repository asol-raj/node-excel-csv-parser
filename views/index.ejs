<div class="card p-4 p-md-5">
    <div class="text-center mb-4">
        <h1 class="h2">Excel & CSV to JSON Converter</h1>
        <p class="text-muted">Upload your file to instantly see the JSON output.</p>
    </div>

    <!-- Upload Form -->
    <form action="/upload" method="POST" enctype="multipart/form-data" id="uploadForm">
        <div class="input-group mb-3">
            <input type="file" class="form-control" id="file" name="file" accept=".csv, .xlsx, .xls" required>
            <button class="btn btn-primary" type="submit" id="submitButton">
                <span id="buttonText">Upload & Convert</span>
                <span id="spinner" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
            </button>
        </div>
    </form>

    <!-- Display Error Messages -->
    <% if (error) { %>
        <div class="alert alert-danger mt-4" role="alert">
            <%= error %>
        </div>
    <% } %>

    <!-- Display JSON Data -->
    <% if (data && data.length > 0) { %>
        <div class="mt-4">
            <h3 class="h5">JSON Output:</h3>
            <pre class="json-output"><code><%= JSON.stringify(data, null, 2) %></code></pre>
        </div>
        <div class="mt-2 text-center">Rows: <%= data.length %>, Columns: <%= Object.keys(data[0]).length %></div>
    <% } else if (data && data.length === 0) { %>
         <div class="alert alert-warning mt-4" role="alert">
            File processed successfully, but it appears to be empty.
        </div>
    <% } %>

</div>

<script>
    // Simple script to show a loading spinner on form submission
    document.getElementById('uploadForm').addEventListener('submit', function() {
        document.getElementById('buttonText').classList.add('d-none');
        document.getElementById('spinner').classList.remove('d-none');
        document.getElementById('submitButton').disabled = true;
    });
</script>
